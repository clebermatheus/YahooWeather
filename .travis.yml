language: android
jdk: oraclejdk8
dist: trusty
sudo: required
group: deprecated-2017Q4

android:
  components:
      - platform-tools
      - tools
      - build-tools-27.0.3
      - $ANDROID_TARGET
      - extra-android-support
      - extra-android-m2repository
      - extra-google-m2repository
  licenses:
      - 'android-sdk-license-.+'
      - 'google-gdk-license-.+'

env:
  matrix:
    - ANDROID_TARGET=android-27 ANDROID_ABI=armeabi-v7a

before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
      - $HOME/.gradle/caches/
      - $HOME/.gradle/wrapper/
      - $HOME/.android/build-cache

before_install:
  - yes | sdkmanager "platforms;$ANDROID_TARGET"

script:
    - echo "Travis branch is $TRAVIS_BRANCH"
    - echo "Travis branch is in pull request $TRAVIS_PULL+REQUEST"
    - ./gradlew check
    - ./gradlew build connectedCheck

